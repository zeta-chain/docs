---
title: ä» Sui å‘èµ·è°ƒç”¨
---

ZetaChain è®©åŸºäº Sui çš„åº”ç”¨èƒ½å¤Ÿç›´æ¥ä¸éƒ¨ç½²åœ¨ ZetaChain ä¸Šçš„å…¨é“¾æ™ºèƒ½åˆçº¦äº¤äº’ã€‚å€ŸåŠ© ZetaChain çš„å…¨é“¾äº’æ“ä½œå±‚ï¼ŒSui åº”ç”¨å¯ä»¥ï¼š

- å°† SUI ä¸å—æ”¯æŒçš„åŒè´¨åŒ–ä»£å¸å­˜å…¥ ZetaChain
- å‘å…¨é“¾åˆçº¦å‘èµ·è·¨é“¾è°ƒç”¨
- æ¥æ”¶æ¥è‡ªå…¨é“¾åˆçº¦çš„è·¨é“¾è°ƒç”¨ä¸ä»£å¸è½¬è´¦

æœ¬æ•™ç¨‹å°†æ•™ä½ ï¼š

- åŒæ—¶è¿è¡Œ ZetaChain ä¸ Sui çš„æœ¬åœ°å¼€å‘ç¯å¢ƒ
- åœ¨ ZetaChain éƒ¨ç½²å…¨é“¾åˆçº¦
- å°† SUI ä»£å¸ä» Sui åœ°å€å­˜å…¥ ZetaChain
- é€šè¿‡è·¨é“¾è°ƒç”¨è§¦å‘å…¨é“¾åˆçº¦ä¸­çš„å‡½æ•°

å®Œæˆåï¼Œä½ å°†æŒæ¡å¦‚ä½•ä» Sui è½¬ç§»èµ„äº§ã€è§¦å‘ ZetaChain é€»è¾‘ï¼Œæ— è®ºæ˜¯é€šè¿‡å®¢æˆ·ç«¯é’±åŒ…è¿˜æ˜¯ Sui åˆçº¦ã€‚

## å‰ç½®æ¡ä»¶

å¼€å§‹å‰è¯·å®‰è£…ä»¥ä¸‹å·¥å…·ï¼š

| å·¥å…· | ç”¨é€” |
| --- | --- |
| [Sui CLI](https://docs.sui.io/references/cli) | è¿è¡Œæœ¬åœ° Sui éªŒè¯èŠ‚ç‚¹ã€ç®¡ç†åœ°å€ä¸å¯¹è±¡ã€éƒ¨ç½²åˆçº¦ |
| [Foundry](https://getfoundry.sh/) | ä½¿ç”¨ `cast` ä¸ºè·¨é“¾è°ƒç”¨ç¼–ç  ABI è½½è· |
| [Node.js](https://nodejs.org/en) | è¿è¡Œ ZetaChain CLI ä¸åŸºäº JavaScript çš„å·¥å…· |
| [Yarn](https://yarnpkg.com/) | å®‰è£…ä¸ç®¡ç†é¡¹ç›®ä¾èµ– |
| [jq](https://jqlang.org/) | åœ¨è„šæœ¬ä¸­è§£æ JSON è¾“å‡º |

## å…‹éš†ç¤ºä¾‹é¡¹ç›®

ä½¿ç”¨ ZetaChain CLI ç”Ÿæˆé¡¹ç›®ï¼š

```bash
npx zetachain@latest new --project call
cd call
```

è¯¥æ¨¡æ¿å·²åŒ…å« Sui ä¸ ZetaChain åˆçº¦ç¤ºä¾‹ã€‚

å®‰è£…ä¾èµ–ï¼š

```bash
yarn
forge soldeer update
```

ç¯å¢ƒç°å·²å¯ç”¨äºæœ¬åœ°å¼€å‘ä¸æµ‹è¯•ã€‚

## å¯åŠ¨ Localnet

åŒæ—¶å¯åŠ¨ ZetaChain ä¸ Sui çš„æœ¬åœ°ç¯å¢ƒï¼š

```bash
yarn zetachain localnet start --chains sui
```

è¯¥å‘½ä»¤ä¼šå¯åŠ¨ï¼š

- æœ¬åœ° ZetaChain å®ä¾‹
- æœ¬åœ° Sui éªŒè¯èŠ‚ç‚¹
- ä¸¤æ¡ç½‘ç»œä¸Šçš„é¢„éƒ¨ç½² Gateway åˆçº¦

è¯·ä¿æŒè¯¥ç»ˆç«¯è¿è¡Œã€‚å¯åŠ¨æˆåŠŸåä¼šçœ‹åˆ°ç±»ä¼¼è¡¨æ ¼ï¼š

```
SUI
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ (index)          â”‚ Values                                                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ gatewayPackageId â”‚ '0x17360c15c10bbc4ebc57e9872f2993dc4376f7f0bb78920fe5fa9ad276ac7f86'             â”‚
â”‚ gatewayObjectId  â”‚ '0x9a26d6b6f413228bb120446977a8d8003eceb490cb7afd8921494815adc0a497'             â”‚
â”‚ userMnemonic     â”‚ 'grape subway rack mean march bubble carry avoid muffin consider thing street'   â”‚
â”‚ userAddress      â”‚ '0x2fec3fafe08d2928a6b8d9a6a77590856c458d984ae090ccbd4177ac13729e65'             â”‚
â”‚ tokenUSDC        â”‚ '6b0b8d1bbc40893a7f793f52c46aeea9db9f2f710c6a623c666bff712e26c94a::token::TOKEN' â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

> ğŸ’¡ è¯·å¦¥å–„ä¿ç•™ `gatewayPackageId`ã€`gatewayObjectId` ä¸ `userMnemonic`ï¼Œåç»­æ­¥éª¤ä¼šç”¨åˆ°ã€‚

## éƒ¨ç½²å…¨é“¾åˆçº¦

æ¥ä¸‹æ¥éƒ¨ç½² ZetaChain ä¸Šçš„å…¨é“¾åˆçº¦ã€‚

é¦–å…ˆä»æœ¬åœ°ç¯å¢ƒè·å– Gateway åœ°å€ä¸é¢„ç½®ç§é’¥ï¼š

```bash
GATEWAY_ZETACHAIN=$(jq -r '.["31337"].contracts[] | select(.contractType == "gateway") | .address' ~/.zetachain/localnet/registry.json) && echo $GATEWAY_ZETACHAIN
```

```bash
PRIVATE_KEY=$(jq -r '.private_keys[0]' ~/.zetachain/localnet/anvil.json) && echo $PRIVATE_KEY
```

ç¼–è¯‘åˆçº¦ï¼š

```
forge build
```

éƒ¨ç½² `Universal` åˆçº¦ï¼š

```bash
UNIVERSAL=$(forge create Universal \
  --rpc-url http://localhost:8545 \
  --private-key $PRIVATE_KEY \
  --broadcast \
  --json \
  --constructor-args $GATEWAY_ZETACHAIN | jq -r .deployedTo) && echo $UNIVERSAL
```

## å­˜å…¥ ZetaChain

éƒ¨ç½²å®Œæˆåï¼Œå³å¯é€šè¿‡ Sui Gateway åˆçº¦å°† SUI å­˜å…¥ ZetaChain ä¸Šçš„å…¨é“¾åˆçº¦ã€‚

ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ä» Sui å­˜å…¥ä»£å¸ï¼š

```bash
npx zetachain sui deposit \
  --mnemonic "grape subway rack mean march bubble carry avoid muffin consider thing street" \
  --receiver $UNIVERSAL \
  --gateway-package 0x17360c15c10bbc4ebc57e9872f2993dc4376f7f0bb78920fe5fa9ad276ac7f86 \
  --gateway-object 0x9a26d6b6f413228bb120446977a8d8003eceb490cb7afd8921494815adc0a497 \
  --amount 0.001 \
  --chain-id 104
```

> ğŸ” è¯·å°† `--gateway-package` ä¸ `--gateway-object` æ›¿æ¢ä¸ºä½ æœ¬åœ°è¾“å‡ºä¸­çš„å®é™…å€¼ã€‚

è¯¥å‘½ä»¤ä¼šè°ƒç”¨ Sui Gateway çš„å­˜å…¥å‡½æ•°ã€‚ZetaChain ç›‘å¬åˆ°å­˜å…¥äº‹ä»¶åï¼Œä¼šé“¸é€ ç­‰é‡ ZRC-20 SUIï¼Œå¹¶è½¬å…¥å…¨é“¾åˆçº¦ã€‚

## å­˜å…¥å¹¶è°ƒç”¨

æ­¤æ­¥éª¤åœ¨å­˜å…¥ SUI çš„åŒæ—¶è°ƒç”¨å…¨é“¾åˆçº¦ï¼š

```bash
npx zetachain sui deposit-and-call \
  --mnemonic "grape subway rack mean march bubble carry avoid muffin consider thing street" \
  --receiver $UNIVERSAL \
  --gateway-package 0x17360c15c10bbc4ebc57e9872f2993dc4376f7f0bb78920fe5fa9ad276ac7f86 \
  --gateway-object 0x9a26d6b6f413228bb120446977a8d8003eceb490cb7afd8921494815adc0a497 \
  --amount 0.001 \
  --chain-id 104 \
  --types string \
  --values hello
```

å‘½ä»¤ä¼šè°ƒç”¨ Sui Gateway çš„ `deposit_and_call`ï¼Œå°† SUI ä¸è½½è·ï¼ˆæ­¤å¤„ä¸º `"hello"`ï¼‰ä¸€å¹¶å‘é€åˆ° ZetaChainï¼Œè§¦å‘å…¨é“¾åˆçº¦çš„ `onCall`ã€‚

## æ„å»ºå¹¶éƒ¨ç½² Sui åˆçº¦

ä½ è¿˜å¯ä»¥éƒ¨ç½²ä¸€ä¸ª Sui åˆçº¦ï¼Œåœ¨é“¾ä¸Šé€»è¾‘ä¸­å‘èµ·å­˜å…¥æ“ä½œã€‚

è¿›å…¥ Sui åˆçº¦ç›®å½•ï¼š

```bash
cd sui
```

æŸ¥çœ‹ `Move.toml`ï¼š

```toml filename="sui/Move.toml"
[dependencies]
gateway = { local = "/usr/local/share/localnet/protocol-contracts-sui" }
```

ç¤ºä¾‹é¡¹ç›®å·²å¼•å…¥ Localnet çš„ Gateway æ¨¡å—ã€‚è‹¥åœ¨æµ‹è¯•ç½‘/ä¸»ç½‘ä½¿ç”¨ï¼Œå°†å¼•ç”¨å…¬å…±åœ°å€ã€‚

æ„å»º Sui åˆçº¦ï¼š

```bash
sui move build --force
```

å°†åŒ…å‘å¸ƒåˆ°æœ¬åœ° Suiï¼š

```bash
SUI_CONTRACT=$(sui client publish \
  --skip-dependency-verification \
  --json 2>/dev/null | jq -r '.objectChanges[] | select(.type == "published") | .packageId') && echo $SUI_CONTRACT
```

## é€šè¿‡æ°´é¾™å¤´è·å–ä»£å¸

ä½ çš„ Sui è´¦æˆ·éœ€è¦ä¸€äº› SUI æ”¯ä»˜äº¤æ˜“è´¹ã€‚é€šè¿‡æœ¬åœ°æ°´é¾™å¤´è·å–ï¼š

```bash
sui client faucet
```

## ä» Sui åˆçº¦å‘èµ·å­˜å…¥å¹¶è°ƒç”¨

åœ¨ Sui ä¸­ï¼Œå¯é€šè¿‡ Programmable Transaction Blockï¼ˆPTBï¼‰å®ç°å¤æ‚äº¤æ˜“ï¼šç»„åˆå¤šæ­¥æ“ä½œå¹¶ä½œä¸ºå•ç¬”äº¤æ˜“æäº¤ã€‚å®¢æˆ·ç«¯åº”ç”¨æ„å»ºå¹¶ç­¾å PTBï¼Œæäº¤åç”± Sui ä¸€æ¬¡æ€§æ‰§è¡Œã€‚

é¡¹ç›®ä¸­å·²æœ‰ TypeScript å‘½ä»¤ `commands/suiDepositAndCall.ts`ï¼Œé»˜è®¤ç›´æ¥æ„å»º ABI è½½è·å¹¶è°ƒç”¨ Sui Gatewayã€‚æˆ‘ä»¬å°†å…¶ä¿®æ”¹ä¸ºï¼š

1. å…ˆè°ƒç”¨è‡ªå®šä¹‰çš„ Sui åˆçº¦å¹¶è·å–è¿”å›å€¼
2. å°†è¿”å›å€¼ä½œä¸ºè½½è·ä¼ é€’ç»™ Sui Gateway

æ‰“å¼€ `commands/suiDepositAndCall.ts`ï¼Œä¿®æ”¹è½½è·æ„é€ ï¼š

```ts filename="commands/suiDepositAndCall.ts"
// const payload = tx.pure.vector("u8", utils.arrayify(payloadABI));

const payload = tx.moveCall({
  target: `${options.connected}::connected::hello`,
  arguments: [tx.pure.string(params.values[0] as string)],
});
```

è¿™ä¼šè°ƒç”¨ `connected::hello`ï¼Œè¿”å›å€¼å³ä½œä¸ºè½½è·è½¬å‘ç»™ Gateway çš„ `deposit_and_call`ã€‚

ç”±äº Sui åˆçº¦ä¸ä¾¿ç›´æ¥ç¼–ç  EVM æ‰€éœ€æ•°æ®ï¼Œæˆ‘ä»¬å°†å…¨é“¾åˆçº¦çš„ `onCall` ç­¾åæ”¹ä¸ºæ¥æ”¶ `bytes` å¹¶æŒ‰ UTF-8 è§£è¯»ï¼š

```solidity
function onCall(
    MessageContext calldata context,
    address zrc20,
    uint256 amount,
    bytes calldata message
) external override onlyGateway {
    // string memory name = abi.decode(message, (string));
    emit HelloEvent("Hello on ZetaChain", string(message));
}
```

é‡æ–°æ„å»ºå¹¶éƒ¨ç½²åˆçº¦ï¼š

```bash
forge build
```

```bash
UNIVERSAL=$(forge create Universal \
  --rpc-url http://localhost:8545 \
  --private-key $PRIVATE_KEY \
  --broadcast \
  --json \
  --constructor-args $GATEWAY_ZETACHAIN | jq -r .deployedTo) && echo $UNIVERSAL
```

ç°åœ¨æ‰§è¡Œ PTBï¼šè°ƒç”¨ Sui åˆçº¦è·å–è¿”å›å€¼ï¼Œå°†å…¶ä¼ ç»™ Sui Gatewayï¼Œå†ç”± Gateway è°ƒç”¨ ZetaChain ä¸Šçš„å…¨é“¾åˆçº¦ï¼š

```bash
npx tsx commands deposit-and-call \
  --private-key suiprivkey1qrqtrevmd40vxlv3q6fcgmm09af5p8f8j67ezve0u3nhrs0psslgjnw3y5p \
  --receiver $UNIVERSAL \
  --gateway-package 0xc52d19fd2f0bcb94d0c285d480b6a8af515f5ec19d0cff8818fc9bf0d3731b85 \
  --gateway-object 0xa755a1106ae7039a25c10578b6f3c5b73963055e0d6fc40e8abcebea454a6389 \
  --amount 0.001 \
  --chain-id 104 \
  --types string \
  --values alice \
  --connected $SUI_CONTRACT
```

ç»ˆç«¯ä¸­åº”çœ‹åˆ°ç±»ä¼¼äº‹ä»¶è¾“å‡ºï¼š

```
[ZetaChain] Event from onCall: {"_type":"log","address":"0xa6e99A4ED7498b3cdDCBB61a6A607a4925Faa1B7",...}
```

å¯é€šè¿‡è§£ç æ—¥å¿—éªŒè¯ï¼š

```bash
cast abi-decode "data()(string,string)" \
  0x0000000000000000000000000000000000000000000000000000000000000040...
```

é¢„æœŸè¾“å‡ºï¼š

```
"Hello on ZetaChain"
"hello alice"
```

è‡³æ­¤ï¼Œä½ å·²å®Œæˆä» Sui åˆçº¦åˆ° ZetaChain çš„è·¨é“¾è°ƒç”¨ï¼Œå¹¶æŒæ¡äº†å®šåˆ¶è½½è·ä¸äº‹ä»¶å¤„ç†çš„æµç¨‹ã€‚***

