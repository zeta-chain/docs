ä½¿ç”¨ ZetaChain ä¸ Solana æ„å»ºå…¨é“¾åº”ç”¨éå¸¸ç®€å•ã€‚ä½ å¯ä»¥ç›´æ¥ä» Solana å­˜å…¥ SOL ä¸ SPL-20 ä»£å¸åˆ° ZetaChain çš„è´¦æˆ·æˆ–æ™ºèƒ½åˆçº¦ï¼ŒZetaChain ä¸Šçš„å…¨é“¾åˆçº¦å¯ä»¥å¤„ç†è¿™äº›å­˜å…¥ï¼Œå¹¶æ‰§è¡Œç”± Solana å‘èµ·çš„åˆçº¦è°ƒç”¨ã€‚

æœ¬æ•™ç¨‹å°†å¼•å¯¼ä½ ï¼š

- ä½¿ç”¨ localnet æ­å»ºæœ¬åœ°å¼€å‘ç¯å¢ƒ
- åœ¨ ZetaChain éƒ¨ç½²å…¨é“¾åˆçº¦
- ä» Solana å‘ ZetaChain å­˜å…¥ä»£å¸ï¼ˆSOL ä¸ SPL-20ï¼‰
- æ‰§è¡Œ deposit-and-call äº¤æ˜“ï¼Œåœ¨å­˜å…¥ä»£å¸çš„åŒæ—¶è°ƒç”¨å…¨é“¾åº”ç”¨
- å°†ä»£å¸æç°å› Solanaï¼Œå¹¶åœ¨æç°è¿‡ç¨‹ä¸­å¯é€‰è°ƒç”¨ Solana ç¨‹åº

ä¸ Solana çš„äº¤äº’ç”± Solana Gateway ç¨‹åºå¤„ç†ï¼Œè¯¦è§[æ–‡æ¡£è¯´æ˜](/developers/chains/solana)ã€‚

## å‰ç½®æ¡ä»¶

å¼€å§‹å‰è¯·ç¡®ä¿å·²å®‰è£…å¹¶é…ç½®ï¼š

- [`solana` CLI](https://solana.com/docs/intro/installation)

## å…‹éš†ç¤ºä¾‹é¡¹ç›®

åˆ›å»ºé¡¹ç›®å¹¶å®‰è£…ä¾èµ–ï¼š

```bash
npx zetachain@latest new --project call
cd call
yarn
```

## å¯åŠ¨ Localnet

è¿è¡Œä»¥ä¸‹å‘½ä»¤å¯åŠ¨åŒ…å« ZetaChain ä¸ Solana çš„æœ¬åœ°å¼€å‘ç¯å¢ƒï¼š

```bash
yarn zetachain localnet start
```

è¯·ä¿æŒè¯¥ç»ˆç«¯è¿è¡Œã€‚

## ç¼–è¯‘å¹¶éƒ¨ç½²ç¤ºä¾‹å…¨é“¾åˆçº¦

åœ¨æ–°ç»ˆç«¯çª—å£ä¸­ç¼–è¯‘å¹¶éƒ¨ç½²å…¨é“¾åˆçº¦ï¼š

```bash
npx hardhat compile --force
npx hardhat deploy --name Universal --network localhost --gateway 0x5FC8d32690cc91D4c39d9d3abcBD16989F875707
```

æ‰§è¡Œåä¼šè¾“å‡ºåˆçº¦éƒ¨ç½²æˆåŠŸçš„æç¤ºï¼š

```
ğŸš€ Successfully deployed "Universal" contract on localhost.
ğŸ“œ Contract address: 0x8198f5d8F8CfFE8f9C413d98a0A55aEB8ab9FbB7
```

è¯·è®°å½•åˆçº¦åœ°å€ï¼ˆæ­¤ç¤ºä¾‹ä¸º `0x8198f5d8F8CfFE8f9C413d98a0A55aEB8ab9FbB7`ï¼‰ï¼Œåç»­ä¼šç”¨åˆ°ã€‚

## å­˜å…¥ SOL

ä» Solana å‘ ZetaChain å­˜å…¥ SOLï¼š

```
npx hardhat localnet:solana-deposit \
  --receiver 0x8198f5d8F8CfFE8f9C413d98a0A55aEB8ab9FbB7 \
  --amount 0.1
```

- `--receiver`ï¼šZetaChain ä¸Šçš„å…¨é“¾åˆçº¦åœ°å€
- `--amount`ï¼šæ¬²å­˜å…¥çš„ SOL æ•°é‡

## å­˜å…¥å¹¶è°ƒç”¨

åœ¨å­˜å…¥ä»£å¸çš„åŒæ—¶è°ƒç”¨å·²éƒ¨ç½²çš„å…¨é“¾åˆçº¦ï¼š

```bash
npx hardhat localnet:solana-deposit-and-call \
  --receiver 0x8198f5d8F8CfFE8f9C413d98a0A55aEB8ab9FbB7 \
  --amount 0.1 \
  --types '["string"]' hello
```

è¯¥å‘½ä»¤ä¼šåœ¨å­˜å…¥ä»£å¸çš„åŒæ—¶å‘åˆçº¦ä¼ å…¥å­—ç¬¦ä¸²å‚æ•° `"hello"`ã€‚

## æç°è‡³ Solana

å°†ä»£å¸ä» ZetaChain æç°å› Solanaï¼š

```bash
npx hardhat zetachain-withdraw \
  --gateway-zeta-chain 0x5FC8d32690cc91D4c39d9d3abcBD16989F875707 \
  --receiver DrexsvCMH9WWjgnjVbx1iFf3YZcKadupFmxnZLfSyotd \
  --network localhost \
  --zrc20 0xd97B1de3619ed2c6BEb3860147E30cA8A7dC9891 \
  --amount 0.1
```

- `--gateway-zeta-chain`ï¼šZetaChain Gateway åœ°å€
- `--receiver`ï¼šæ¥æ”¶æç°ä»£å¸çš„ Solana é’±åŒ…åœ°å€
- `--zrc20`ï¼šç›®æ ‡æç°ä»£å¸åœ¨ ZetaChain ä¸Šçš„ ZRC-20 åœ°å€
- `--amount`ï¼šæç°æ•°é‡

## æç°å¹¶è°ƒç”¨ Solana ç¨‹åº

é™¤äº†å•çº¯æç°å¤–ï¼Œè¿˜å¯ä»¥åœ¨æç°è¿‡ç¨‹ä¸­è°ƒç”¨ Solana ç¨‹åºï¼Œå®ç°æ›´å¤æ‚çš„æ“ä½œï¼Œä¾‹å¦‚åœ¨æ”¶æ¬¾æ—¶è‡ªåŠ¨æ‰§è¡Œåˆçº¦é€»è¾‘ã€è´¨æŠ¼æˆ–å…‘æ¢ã€‚

é¡¹ç›® `solana` ç›®å½•ä¸­æä¾›äº†ç¤ºä¾‹ç¨‹åºï¼ŒåŒ…å«å¯ç”± ZetaChain å…¨é“¾åº”ç”¨åœ¨æç°æ—¶è°ƒç”¨çš„ `on_call` å‡½æ•°ã€‚

ä»¥ä¸‹æ­¥éª¤å±•ç¤ºå¦‚ä½•æ„å»ºç¤ºä¾‹ç¨‹åºï¼Œå¹¶é€šè¿‡ ZetaChain Gateway æ‰§è¡Œ â€œwithdraw and callâ€ã€‚

### æ„å»ºå¹¶é…ç½®ç¤ºä¾‹ Solana ç¨‹åº

è®¾ç½® SPL-20 USDC åœ°å€ï¼Œå¯åœ¨ `localnet` è¾“å‡ºè¡¨æ ¼ä¸­æ‰¾åˆ°ï¼š

```bash
USDC_SPL=3Kx5SY7SwzdUZSorLVSpPgxBL8DZFiu8mg4FWduu2tQp
```

```bash
cd solana && anchor build && npx ts-node setup/main.ts "$USDC_SPL" && cd -
```

å®Œæˆåä¼šè¾“å‡ºç±»ä¼¼ä¿¡æ¯ï¼Œè¡¨ç¤ºç¨‹åºéƒ¨ç½²æˆåŠŸï¼š

```
Connected program deployment output: Program Id: 9BjVGjn28E58LgSi547JYEpqpgRoo1TErkbyXiRSNDQy
```

### æç° SOL å¹¶è°ƒç”¨ Solana ç¨‹åº

é€šè¿‡ ZetaChain Gateway æç° SOL å¹¶è°ƒç”¨ Solana ç¨‹åºï¼š

```bash
npx hardhat zetachain-withdraw-and-call \
  --receiver 9BjVGjn28E58LgSi547JYEpqpgRoo1TErkbyXiRSNDQy \
  --gateway-zeta-chain 0x5FC8d32690cc91D4c39d9d3abcBD16989F875707 \
  --zrc20 0xd97B1de3619ed2c6BEb3860147E30cA8A7dC9891 \
  --amount 0.01 \
  --network localhost \
  --types '["bytes"]' $(npx ts-node solana/setup/encodeCallArgs.ts "sol" "$USDC_SPL")
```

- `--receiver`ï¼šéœ€è¦è°ƒç”¨çš„ Solana ç¨‹åº ID
- `--types '["bytes"]'`ï¼šè¡¨ç¤ºåˆçº¦è°ƒç”¨å‚æ•°ä¸ºå­—èŠ‚æ•°ç»„ï¼ˆå³ç¼–ç åçš„ Solana è°ƒç”¨æ•°æ®ï¼‰
- å¼•å·ä¸­çš„å‘½ä»¤ä¼šç”Ÿæˆç¼–ç åçš„è´¦æˆ·ä¸æ•°æ®
- `--zrc20`ï¼šZetaChain ä¸Š SOL çš„ ZRC-20 åœ°å€

### æç° SPL-20 å¹¶è°ƒç”¨ Solana ç¨‹åº

å°† ZRC-20 å½¢å¼çš„ SPL-20 USDC æç°åŒæ—¶è°ƒç”¨ Solana ç¨‹åºï¼š

```bash
npx hardhat zetachain-withdraw-and-call \
  --receiver 9BjVGjn28E58LgSi547JYEpqpgRoo1TErkbyXiRSNDQy \
  --gateway-zeta-chain 0x5FC8d32690cc91D4c39d9d3abcBD16989F875707 \
  --zrc20 0x48f80608B672DC30DC7e3dbBd0343c5F02C738Eb \
  --amount 0.01 \
  --network localhost \
  --types '["bytes"]' $(npx ts-node solana/setup/encodeCallArgs.ts "spl" "$USDC_SPL")
```

- `--zrc20`ï¼šZetaChain ä¸Š SPL-20 USDC çš„ ZRC-20 åœ°å€

é€šè¿‡æœ¬æ•™ç¨‹ï¼Œä½ å·²å­¦ä¼šåœ¨ ZetaChain éƒ¨ç½²å…¨é“¾åˆçº¦ã€ä» Solana å­˜å…¥ SOL ä¸ SPL-20ã€åœ¨å­˜å…¥æ—¶è°ƒç”¨åˆçº¦ã€å°†èµ„äº§æç°å› Solanaï¼Œå¹¶åœ¨æç°æ—¶è§¦å‘ Solana ç¨‹åºï¼Œä¸ºè·¨é“¾äº¤äº’æä¾›æ›´å¤šæ‰©å±•ç©æ³•ã€‚

